

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Task1 &#8212; Webinar and Q&amp;A - May 2023</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'task1';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="The GitHub Tools" href="claritycadenza_tools.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/cadenza_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/cadenza_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Cadenza Webinar - May 2023
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="claritycadenza_tools.html">The GitHub Tools</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Task1</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/groadabike/cadenza_webinar_may2023/master?urlpath=tree/docs/task1.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/groadabike/cadenza_webinar_may2023/blob/master/docs/task1.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/groadabike/cadenza_webinar_may2023" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/groadabike/cadenza_webinar_may2023/issues/new?title=Issue%20on%20page%20%2Ftask1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/task1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Task1</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cloning-the-clarity-repository">1. Cloning the Clarity Repository</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-the-demo-data">2. Getting the demo data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#baseline">3. Baseline</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enhancement">3.1 Enhancement</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#enhance">3.1.1 Enhance</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#decompose-signal">3.1.2 Decompose Signal</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#process-stems-for-listeners">3.1.3 Process Stems for Listeners</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#remix-signal">3.1.4 Remix Signal</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#utility-functions">3.1.5 Utility Functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation">3.2 Evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#run-calculate-aq">3.2.1 Run calculate aq</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-song-seed">3.2.2 Set Song Seed</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-song-listener">3.2.3 Evaluate Song Listener</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspecting-existing-configuration">4. Inspecting Existing Configuration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-demo">5. Run Demo</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="task1">
<h1>Task1<a class="headerlink" href="#task1" title="Permalink to this heading">#</a></h1>
<p>This tutorial walks through the process of running the CAD1 Task1 baseline using the shell Interface</p>
<p>The python and shell scripts included in the repository make use of <a href='https://hydra.cc/'>Hydra</a> and <a href='https://hydra.cc/docs/plugins/submitit_launcher/'>Submitit</a>, two technologies which streamline the configuration and parallel operation of python code on both local and high performance computing (HPC) environments.</p>
<p>The use of hydra for configuration allows for the existing shell scripts to be easily redirected to include new audio data and modify the various parameters of the recipe.</p>
<section id="cloning-the-clarity-repository">
<h2>1. Cloning the Clarity Repository<a class="headerlink" href="#cloning-the-clarity-repository" title="Permalink to this heading">#</a></h2>
<p>We first need to install the Clarity package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%%capture
!git clone --quiet https://github.com/claritychallenge/clarity.git
%cd clarity
!git checkout v0.3.2
%pip install -e .
%cd recipes/cad1/task1/baseline
</pre></div>
</div>
</div>
</div>
</section>
<section id="getting-the-demo-data">
<h2>2. Getting the demo data<a class="headerlink" href="#getting-the-demo-data" title="Permalink to this heading">#</a></h2>
<p>We will be using music audio and listener metadata.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%%capture

import gdown

!gdown 10SfuZR7yVlVO6RwNUc3kPeJHGiwpN3VS
!mv cadenza_data_demo.tar.xz recipes/cad1/task1/baseline
!tar -xvf cadenza_data_demo.tar.xz
!rm cadenza_data_demo.tar.xz
</pre></div>
</div>
</div>
</div>
</section>
<section id="baseline">
<h2>3. Baseline<a class="headerlink" href="#baseline" title="Permalink to this heading">#</a></h2>
<p>The baseline recipe is divided into 2 stage; <strong>Enhnacement</strong> and <strong>Evaluation</strong></p>
<a class="reference internal image-reference" href="_images/headphone_simple_v2.png"><img alt="Task1" class="align-center" src="_images/headphone_simple_v2.png" style="width: 800px;" /></a>
<section id="enhancement">
<h3>3.1 Enhancement<a class="headerlink" href="#enhancement" title="Permalink to this heading">#</a></h3>
<p>The enhancement script contains several key functions</p>
<section id="enhance">
<h4>3.1.1 Enhance<a class="headerlink" href="#enhance" title="Permalink to this heading">#</a></h4>
<p>The main function that orchestrate the demixing and remixing.</p>
<ul class="simple">
<li><p>It takes the config.yaml as input parameter</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@hydra</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">config_name</span><span class="o">=</span><span class="s2">&quot;config&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">enhance</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the music enhancement.</span>
<span class="sd">    The system decomposes the music into vocal, drums, bass, and other stems.</span>
<span class="sd">    Then, the NAL-R prescription procedure is applied to each stem.</span>
<span class="sd">    Args:</span>
<span class="sd">        config (dict): Dictionary of configuration options for enhancing music.</span>

<span class="sd">    Returns 8 stems for each song:</span>
<span class="sd">        - left channel vocal, drums, bass, and other stems</span>
<span class="sd">        - right channel vocal, drums, bass, and other stems</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="decompose-signal">
<h4>3.1.2 Decompose Signal<a class="headerlink" href="#decompose-signal" title="Permalink to this heading">#</a></h4>
<p>It takes a music signal and a pretrained model decompose the signal into eight stems (VDBO).</p>
<ul class="simple">
<li><p>The baseline takes either the demucs or the Open-UnMix model acording to the value of the <code class="docutils literal notranslate"><span class="pre">separator.model</span></code> parameter in the config.yaml</p></li>
<li><p>The function has the left and right audiograms as input parameters. This is to show that one could train a model using this information to produces a personalizes decomposition.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">decompose_signal</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">model_sample_rate</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">signal</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">signal_sample_rate</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
    <span class="n">sources_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">left_audiogram</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">right_audiogram</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">normalise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decompose signal into 8 stems.</span>

<span class="sd">    The left and right audiograms are ignored by the baseline system as it</span>
<span class="sd">    is performing personalised decomposition.</span>
<span class="sd">    Instead, it performs a standard music decomposition using the</span>
<span class="sd">    HDEMUCS model trained on the MUSDB18 dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (torch.nn.Module): Torch model.</span>
<span class="sd">        model_sample_rate (int): Sample rate of the model.</span>
<span class="sd">        signal (np.ndarray): Signal to be decomposed.</span>
<span class="sd">        signal_sample_rate (int): Sample frequency.</span>
<span class="sd">        device (torch.device): Torch device to use for processing.</span>
<span class="sd">        sources_list (list): List of strings used to index dictionary.</span>
<span class="sd">        left_audiogram (np.ndarray): Left ear audiogram.</span>
<span class="sd">        right_audiogram (np.ndarray): Right ear audiogram.</span>
<span class="sd">        normalise (bool): Whether to normalise the signal.</span>

<span class="sd">     Returns:</span>
<span class="sd">         Dictionary: Indexed by sources with the associated model as values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="process-stems-for-listeners">
<h4>3.1.3 Process Stems for Listeners<a class="headerlink" href="#process-stems-for-listeners" title="Permalink to this heading">#</a></h4>
<p>Function that takes the stems from the demixing and process them to the target listener.</p>
<ul class="simple">
<li><p>In the baseline it applies NAL-R prescription to each stem</p></li>
<li><p>The use of this function may becomes unnecessary in the case of having a separation model that performs a personalized decomposition. E.g., the model applies the NAL-R amplification as part of the decomposition.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">process_stems_for_listener</span><span class="p">(</span>
    <span class="n">stems</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">enhancer</span><span class="p">:</span> <span class="n">NALR</span><span class="p">,</span>
    <span class="n">compressor</span><span class="p">:</span> <span class="n">Compressor</span><span class="p">,</span>
    <span class="n">audiogram_left</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">audiogram_right</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">cfs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">apply_compressor</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process the stems from sources.</span>

<span class="sd">    Args:</span>
<span class="sd">        stems (dict) : Dictionary of stems</span>
<span class="sd">        enhancer (NALR) : NAL-R prescription hearing aid</span>
<span class="sd">        compressor (Compressor) : Compressor</span>
<span class="sd">        audiogram_left (np.ndarray) : Left channel audiogram</span>
<span class="sd">        audiogram_right (np.ndarray) : Right channel audiogram</span>
<span class="sd">        cfs (np.ndarray) : Center frequencies</span>
<span class="sd">        apply_compressor (bool) : Whether to apply the compressor</span>

<span class="sd">    Returns:</span>
<span class="sd">        processed_sources (dict) : Dictionary of processed stems</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="remix-signal">
<h4>3.1.4 Remix Signal<a class="headerlink" href="#remix-signal" title="Permalink to this heading">#</a></h4>
<p>Function that generates the remix</p>
<ul class="simple">
<li><p>The baseline just add all processed signals</p></li>
<li><p>This function can be modify to apply any approach you may want to explore.</p>
<ul>
<li><p>Change the level of the stems</p></li>
<li><p>Rebalance left and right channels.</p></li>
<li><p>…</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">remix_signal</span><span class="p">(</span><span class="n">stems</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to remix signal. It takes the eight stems</span>
<span class="sd">    and combines them into a stereo signal.</span>

<span class="sd">    Args:</span>
<span class="sd">        stems (dict) : Dictionary of stems</span>

<span class="sd">    Returns:</span>
<span class="sd">        (np.ndarray) : Remixed signal</span>

<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="utility-functions">
<h4>3.1.5 Utility Functions<a class="headerlink" href="#utility-functions" title="Permalink to this heading">#</a></h4>
<p>These are function that only help to separate general operation.</p>
<ul class="simple">
<li><p>separate_sources : Performs separation inference using any separation model.</p></li>
<li><p>map_to_dict : Reorganised the separated stems into a dictionary</p></li>
<li><p>get_device : Returns the Torch Device (‘cuda’ or ‘cpu’)</p></li>
</ul>
</section>
</section>
<section id="evaluation">
<h3>3.2 Evaluation<a class="headerlink" href="#evaluation" title="Permalink to this heading">#</a></h3>
<p>The evaluation script assumes that exists the <code class="docutils literal notranslate"><span class="pre">exp</span></code> output directory resulting from runing the <code class="docutils literal notranslate"><span class="pre">enhancement.py</span></code> script.</p>
<p>The evaluation script <code class="docutils literal notranslate"><span class="pre">cannot</span></code> be modified or altered in any way.</p>
<section id="run-calculate-aq">
<h4>3.2.1 Run calculate aq<a class="headerlink" href="#run-calculate-aq" title="Permalink to this heading">#</a></h4>
<p>Main function that orchestrate the evaluation</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@hydra</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">config_name</span><span class="o">=</span><span class="s2">&quot;config&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">run_calculate_aq</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate the enhanced signals using the HAAQI metric.&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="set-song-seed">
<h4>3.2.2 Set Song Seed<a class="headerlink" href="#set-song-seed" title="Permalink to this heading">#</a></h4>
<p>Function to seed the random camponents of the HAAQI score.
This ensures a fair comparison between different systems as the seed depends on the song and not on the order of when that song was processed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_song_seed</span><span class="p">(</span><span class="n">song</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set a seed that is unique for the given song&quot;&quot;&quot;</span>
    <span class="n">song_encoded</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">song</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">song_md5</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">song_encoded</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">song_md5</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="evaluate-song-listener">
<h4>3.2.3 Evaluate Song Listener<a class="headerlink" href="#evaluate-song-listener" title="Permalink to this heading">#</a></h4>
<p>Computes the evaluation of a single song-listener pair</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_evaluate_song_listener</span><span class="p">(</span>
    <span class="n">song</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">listener</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">,</span>
    <span class="n">split_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">listener_audiograms</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">enhanced_folder</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate a single song-listener pair</span>

<span class="sd">    Args:</span>
<span class="sd">        song (str): The name of the song to evaluate.</span>
<span class="sd">        listener (str): The name of the listener to evaluate.</span>
<span class="sd">        config (DictConfig): The configuration object.</span>
<span class="sd">        split_dir (str): The name of the split directory.</span>
<span class="sd">        listener_audiograms (dict): A dictionary of audiograms for each listener.</span>
<span class="sd">        enhanced_folder (Path): The path to the folder containing the enhanced signals.</span>

<span class="sd">    Returns:</span>
<span class="sd">        combined_score (float): The combined score for the result.</span>
<span class="sd">        per_instrument_score (dict): A dictionary of scores for each</span>
<span class="sd">            instrument channel in the result.</span>

<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="inspecting-existing-configuration">
<h2>4. Inspecting Existing Configuration<a class="headerlink" href="#inspecting-existing-configuration" title="Permalink to this heading">#</a></h2>
<p>All of the included shell scripts take configurable variables from the yaml files in the same directory as the shell script.Typically these are named <code class="docutils literal notranslate"><span class="pre">config.yaml</span></code>, however, other names may be used if more than one shell script is in a directory.</p>
<p>We can inspect the contents of the config file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">path</span><span class="p">:</span>
<span class="w">  </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">../../cadenza_data_demo/cad1/task1</span>
<span class="w">  </span><span class="nt">metadata_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${path.root}/metadata</span>
<span class="w">  </span><span class="nt">music_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${path.root}/audio/musdb18hq</span>
<span class="w">  </span><span class="nt">music_train_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${path.metadata_dir}/musdb18.train.json</span>
<span class="w">  </span><span class="nt">music_valid_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${path.metadata_dir}/musdb18.valid.json</span>
<span class="w">  </span><span class="nt">listeners_train_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${path.metadata_dir}/listeners.train.json</span>
<span class="w">  </span><span class="nt">listeners_valid_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${path.metadata_dir}/listeners.valid.json</span>
<span class="w">  </span><span class="nt">exp_folder</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./exp_${separator.model}</span><span class="w"> </span><span class="c1"># folder to store enhanced signals and final results</span>

<span class="nt">sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">44100</span><span class="w">       </span><span class="c1"># sample rate of the input mixture</span>
<span class="nt">stem_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">24000</span><span class="w">  </span><span class="c1"># sample rate output stems</span>
<span class="nt">remix_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32000</span><span class="w"> </span><span class="c1"># sample rate for output remixed signal</span>

<span class="nt">nalr</span><span class="p">:</span>
<span class="w">  </span><span class="nt">nfir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">220</span>
<span class="w">  </span><span class="nt">fs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${sample_rate}</span>

<span class="nt">apply_compressor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="nt">compressor</span><span class="p">:</span>
<span class="w">  </span><span class="nt">threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.35</span>
<span class="w">  </span><span class="nt">attenuation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.1</span>
<span class="w">  </span><span class="nt">attack</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="w">  </span><span class="nt">release</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">rms_buffer_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.064</span>

<span class="nt">soft_clip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>

<span class="nt">separator</span><span class="p">:</span>
<span class="w">  </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">demucs</span><span class="w">   </span><span class="c1"># demucs or openunmix</span>
<span class="w">  </span><span class="nt">device</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">~</span>

<span class="nt">evaluate</span><span class="p">:</span>
<span class="w">  </span><span class="nt">set_random_seed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">  </span><span class="nt">small_test</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="w">  </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w">  </span><span class="c1"># Number of batches</span>
<span class="w">  </span><span class="nt">batch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w">       </span><span class="c1"># Batch number to evaluate</span>

<span class="c1"># hydra config</span>
<span class="nt">hydra</span><span class="p">:</span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span>
<span class="w">    </span><span class="nt">dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${path.exp_folder}</span>
</pre></div>
</div>
<p>The general organisation of the config files is hierarchical, with property labels depending on the script in question. The config file for the enhance and evaluate recipes contains configurable paramaters for both scripts. These include:</p>
<ul class="simple">
<li><p>Paths for the locations of audio files, metadata and the export location for generated files</p></li>
<li><p>Paramaters for the NAL-R fitting</p></li>
<li><p>Paramaters for the automatic gain control (AGC) compressor used in the baseline enhancer</p></li>
<li><p>Parameters for the challenge evaluator</p></li>
<li><p>Parameters necessary for Hydra to run</p></li>
</ul>
<p>The path.root parameter defaults to the root of the baseline and must be overrided with a dataset root path when the python script is called in the command line.</p>
<p>e.g</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>user:~$ python mypythonscript.py path.root=&#39;/path/to/project&#39; 
</pre></div>
</div>
<p>In this notebook we will use the environment variable <code>$NBOOKROOT</code> which we defined at the start of the tutorial.</p>
<p>Note the lack of slash at the end of the <code>path.root</code> argument string. If you inspect a variable such as <code>path.metadata_dir</code> you will see that this slash is already included in the line.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>path:
  root: ./
  metadata_dir: ${path.root}/task1/metadata

</pre></div>
</div>
<p>The general form for overriding a parameter in the CLI is dot indexed. For the following entry in a <code>config.yaml</code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">A</span><span class="p">:</span>
<span class="w">  </span><span class="nt">B</span><span class="p">:</span>
<span class="w">    </span><span class="nt">parameter_0</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">some_value</span>
<span class="w">    </span><span class="nt">parameter_1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">some_other_value</span>
</pre></div>
</div>
<p>The CLI syntax to override those values would be:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>User:~$<span class="w"> </span>python<span class="w"> </span>myscript.py<span class="w"> </span>A.B.parameter_0<span class="o">=</span><span class="s2">&quot;new_value&quot;</span><span class="w"> </span>A.B.parameter_1<span class="o">=</span><span class="s2">&quot;another_new_value&quot;</span>
</pre></div>
</div>
</section>
<section id="run-demo">
<h2>5. Run Demo<a class="headerlink" href="#run-demo" title="Permalink to this heading">#</a></h2>
<p>Typically, as stated above, all the work is done within python with configurable variables supplied by a <code>yaml</code> file which is parsed by Hydra inside the python code.</p>
<p>The execution of this code is performed in the CLI and new configuration variable values are supplied as arguments to override defaults.</p>
<p>We are now ready to run the prepared python script. However, the standard configuration is designed to work with the full clarity dataset. We can redirect the script to the correct folders by overriding the appropriate configuration parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python<span class="w"> </span>enhance.py<span class="w"> </span>path.root<span class="o">=</span>../cadenza_data_demo/cad1/task1
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-05-17 17:34:29,688][torchaudio.utils.download][INFO] - The local file (/home/gerardo/.cache/torch/hub/torchaudio/models/hdemucs_high_musdbhq_only.pt) exists. Skipping the download.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-05-17 17:34:31,277][__main__][INFO] - [001/002] Processing Actions - One Minute Smile for L5076...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-05-17 17:34:39,509][__main__][INFO] - [002/002] Processing Actions - One Minute Smile for L5040...
</pre></div>
</div>
</div>
</div>
<p>The enhancement results in eight stems and one remix for all listener-song pairs.</p>
<a class="reference internal image-reference" href="_images/task1_output.png"><img alt="Task1" class="align-center" src="_images/task1_output.png" style="width: 800px;" /></a>
<p>Now that we have enhanced audios we can use the evaluate recipe to generate HAAQI scores for the signals. The evaluation is run in the same manner as the enhancement script.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>!python<span class="w"> </span>evaluate.py<span class="w"> </span>path.root<span class="o">=</span>../cadenza_data_demo/cad1/task1
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "groadabike/cadenza_webinar_may2023",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="claritycadenza_tools.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The GitHub Tools</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cloning-the-clarity-repository">1. Cloning the Clarity Repository</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-the-demo-data">2. Getting the demo data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#baseline">3. Baseline</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enhancement">3.1 Enhancement</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#enhance">3.1.1 Enhance</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#decompose-signal">3.1.2 Decompose Signal</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#process-stems-for-listeners">3.1.3 Process Stems for Listeners</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#remix-signal">3.1.4 Remix Signal</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#utility-functions">3.1.5 Utility Functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation">3.2 Evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#run-calculate-aq">3.2.1 Run calculate aq</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-song-seed">3.2.2 Set Song Seed</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-song-listener">3.2.3 Evaluate Song Listener</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspecting-existing-configuration">4. Inspecting Existing Configuration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-demo">5. Run Demo</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gerardo Roa Dabike, Trevor Cox
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>